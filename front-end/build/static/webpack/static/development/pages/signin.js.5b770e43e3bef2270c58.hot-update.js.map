{"version":3,"file":"static/webpack/static\\development\\pages\\signin.js.5b770e43e3bef2270c58.hot-update.js","sources":["webpack:///./pages/signin.js"],"sourcesContent":["import Layout from \"./components/myLayoutBefore\";\r\nimport bcrypt from \"bcryptjs\";\r\nimport Router from 'next/router';\r\nimport {Alert} from './components/warnAlert';\r\nimport { Post } from \"./components/http\";\r\n\r\nconst boxStyle={\r\n    position:'relative',\r\n    left:'20%',\r\n    textAlign:'center',\r\n    width:\"60%\",\r\n    marginBottom:'20px',\r\n    padding:'30px',\r\n    border:'2px solid  #ffd633',\r\n    borderRadius:'2px',\r\n    \r\n};   \r\nconst bannerStyle ={\r\n    position:'relative',\r\n    left:'20%',\r\n    textAlign:'center',\r\n    marginTop:\"20px\",\r\n    width:\"60%\",\r\n    padding: '10px 10px',\r\n    border:'2px solid  #ffd633',\r\n    backgroundColor:\"#ffd633\",\r\n    borderRadius:'2px',\r\n};\r\n\r\nconst inputStyle ={\r\n    margin: 30,\r\n    outlineStyle: 'none' ,\r\n    border: '1px solid #ccc',\r\n    borderRadius: '3px',\r\n    padding: '10px 10px',\r\n    width: '70%',\r\n    fontSize: '24px',\r\n    fontFamily: \"Microsoft soft\",\r\n\r\n};\r\nvar salt = bcrypt.genSaltSync(10);\r\nclass signin extends React.Component{\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {email: '',\r\n                    password: '',\r\n                    showAlert: 'none',\r\n                    err: '',\r\n                    data:''\r\n                };\r\n      \r\n        this.handleChange = this.handleChange.bind(this);\r\n        this.handleSubmit = this.handleSubmit.bind(this);\r\n        this.handleClose = this.handleClose.bind(this)\r\n      }\r\n    \r\n    handleChange(event) {\r\n        let name = event.target.name;\r\n        let val = event.target.value;\r\n        this.setState({[name]: val});\r\n       \r\n    }\r\n    handleClose(){\r\n        this.setState({\r\n            showAlert:'none'\r\n        })\r\n    }\r\n    handleSubmit(event) {\r\n        event.preventDefault();\r\n        var psw = bcrypt.hashSync(this.state.password, salt);\r\n        console.log(psw)\r\n        var data ={\r\n            email:this.state.email,\r\n            password:psw\r\n        }\r\n      \r\n        Post('signin', data).then(res=>{\r\n            console.log(res)\r\n            if(res=='-1'|| res == '-2'){\r\n                this.setState({showAlert: ' block'})\r\n                this.setState({err: res})\r\n            }else{\r\n                const same = bcrypt.compareSync(this.state.password,res.password)\r\n                console.log(same)\r\n                if(same){\r\n                    localStorage.setItem('uId',res.uId);\r\n                    localStorage.setItem('role',res.role);\r\n                    Router.push({\r\n                        pathname:'/',\r\n                        query: res\r\n                    })\r\n                }else{\r\n                    this.setState({showAlert: ' block'})\r\n                } \r\n            }\r\n        })\r\n       \r\n    \r\n    }\r\n        \r\n      render(){\r\n        return(\r\n            <div>\r\n                <Layout/>\r\n                <div style={{display: this.state.showAlert}}>\r\n                    {this.state.err=='-1'?<Alert title ='warning!' content = 'Invalid email or password!' onClick={this.handleClose}/>:\r\n                    <Alert title ='warning!' content = 'Your application has not been approved! Please wait.' onClick={this.handleClose}/>}\r\n                </div>\r\n                <div style={bannerStyle}>\r\n                    <span>Sign in</span>\r\n                </div>\r\n                <form onSubmit={this.handleSubmit} style={{textAlign: 'center'}}>\r\n                    <div style={boxStyle}>\r\n                    <input style = {inputStyle} required=\"required\" type=\"email\" name= \"email\" placeholder=\"Enter your email\" value={this.state.value} onChange={this.handleChange}/><br/>\r\n                    <input style = {inputStyle} required=\"required\" type=\"password\" name = \"password\" placeholder=\"Enter your password\" value={this.state.value} onChange={this.handleChange}/><br/>\r\n                   \r\n                    <button type=\"submit\" className=\"btn btn-primary btn-lg\" style={{borderRadius:\"4px\",marginTop:\"20px\"}}>Sign in</button>\r\n                    <style jsx>{`\r\n                        input:focus{\r\n                            border-color: #66afe9;\r\n                            outline: 0;\r\n                            -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6);\r\n                            box-shadow: inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6)\r\n                        }\r\n                    `}</style>\r\n                    </div>\r\n                </form> \r\n                <div style={{textAlign:'center'}}>\r\n                        <span style={{color:'red'}}>have no account?&nbsp;&nbsp;</span>\r\n                        <a href='/signup'>sign up</a>\r\n                </div>\r\n                \r\n            </div> \r\n        );\r\n    }\r\n\r\n}\r\nexport default signin;"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;AAWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;AAYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;AAWA;AACA;AAAA;;;;;AACA;AAAA;AACA;AADA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AAJA;AAOA;AACA;AACA;AAXA;AAYA;AACA;;;AACA;AACA;AACA;AACA;AAEA;;;AACA;AACA;AACA;AADA;AAGA;;;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAFA;AAKA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAGA;;;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAJA;AAAA;AAAA;AAeA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;;;;AA7FA;AACA;AA+FA;;;;A","sourceRoot":""}